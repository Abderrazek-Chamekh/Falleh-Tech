<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<BorderPane fx:id="borderPane" prefHeight="683.0" stylesheets="@showPost.css" prefWidth="967.0" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="tn.esprit.Controllers.Blog.Post.ShowPostsController">
    <!-- Center Content (Posts Management) -->
    <center>
        <VBox spacing="20" style="-fx-padding: 25px; -fx-background-color: #E8F5E9; -fx-spacing: 20px;">
            <!-- Header -->
            <HBox alignment="CENTER_LEFT" style="-fx-padding: 0 0 5px 0;">
                <Label fx:id="postsTitleLabel" text="Top 3 Most Liked Posts"
                       style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2E8B57;"/>
            </HBox>

            <!-- Search and Filter -->
            <HBox spacing="15" style="-fx-padding: 0 0 20px 0; -fx-spacing: 15px;">
                <TextField fx:id="searchField" promptText="🔍 Search Publications..."
                           style="-fx-pref-width: 300px; -fx-pref-height: 40px; -fx-background-radius: 20px; -fx-border-radius: 20px; -fx-padding: 0 15px; -fx-font-size: 14px; -fx-background-color: white; -fx-border-color: #E0E0E0; -fx-border-width: 1px;" />
                <ComboBox fx:id="categoryCombo" promptText="Filter by category"
                          style="-fx-pref-width: 200px; -fx-pref-height: 40px; -fx-background-radius: 20px; -fx-border-radius: 20px; -fx-font-size: 14px; -fx-background-color: white; -fx-border-color: #E0E0E0; -fx-border-width: 1px;">
                    <items>
                        <FXCollections fx:factory="observableArrayList">
                            <String fx:value="All" />
                            <String fx:value="Agriculture" />
                            <String fx:value="Technology" />
                            <String fx:value="Recipes" />
                            <String fx:value="Urban Farming" />
                        </FXCollections>
                    </items>
                </ComboBox>
                <Button onAction="#handleRefresh" text="Refresh Page"
                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px 8px 8px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;">
                    <graphic>
                        <ImageView fitHeight="16" fitWidth="16">
                            <image>
                                <Image url="@/Images/icons/reset.gif" />
                            </image>
                        </ImageView>
                    </graphic>
                </Button>
            </HBox>

            <StackPane fx:id="viewContainer" prefHeight="480.0" prefWidth="960.0"
                       style="-fx-background-color: white; -fx-border-color: #2E8B57; -fx-border-radius: 10px; -fx-padding: 10px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 10, 0, 0, 5);">
                <!-- ListView will be shown for non-admin users -->
                <ListView fx:id="postListView" visible="false" managed="false" />

                <!-- TableView will be shown for admin users -->
                <TableView fx:id="postTableView" visible="false" managed="false">
                    <columns>
                        <TableColumn text="Title" fx:id="titleCol"
                                     style=" -fx-font-weight: bold;"/>
                        <TableColumn text="Category" fx:id="categoryCol"
                                     style=" -fx-font-weight: bold;"/>
                        <TableColumn text="Date" fx:id="dateCol"
                                     style="-fx-font-weight: bold; -fx-alignment: CENTER;"/>
                        <TableColumn text="Likes" fx:id="likesCol"
                                     style="-fx-font-weight: bold; -fx-alignment: CENTER;"/>
                        <TableColumn text="Actions" fx:id="actionsCol"
                                     style="-fx-font-weight: bold; -fx-alignment: CENTER;"/>
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                    </columnResizePolicy>
                </TableView>
            </StackPane>

            <HBox fx:id="adminControls" spacing="15" style="-fx-spacing: 15px;">
                <Button fx:id="ajouter" onAction="#handleAjouter" text="➕ Add"
                        style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;" />
                <Button fx:id="mod" onAction="#handleModifier" text="✏️ Edit"
                        style="-fx-background-color: #F39C12; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;" />
                <Button fx:id="supp" onAction="#handleSupprimer" text="🗑️ Delete"
                        style="-fx-background-color: #E74C3C; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;" />
                <Button fx:id="detailsBtn" onAction="#handleDetails" text="🔍 Details"
                        style="-fx-background-color: #3498DB; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;" />
                <Button fx:id="statsBtn" onAction="#handleShowStats" text="📊 Statistics"
                        style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;" />
                <Button onAction="#handleShowWeather" text="Weather"
                        style="-fx-background-color: #16a085; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-graphic-text-gap: 8px; -fx-cursor: hand;">
                    <graphic>
                        <ImageView fitHeight="16" fitWidth="16">
                            <image>
                                <Image url="@/Images/weather/weather.gif" />
                            </image>
                        </ImageView>
                    </graphic>
                </Button>
                <Button fx:id="toggleViewButton" text="Show All Posts" visible="false"
                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 20px; -fx-padding: 8px 12px; -fx-cursor: hand;"
                        onAction="#handleToggleView" />
            </HBox>
        </VBox>
    </center>
</BorderPane>